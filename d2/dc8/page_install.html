<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Blackberry10SDKforSalesforceMobile: Use the SDK in Existing Project</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blackberry10SDKforSalesforceMobile
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Blackberry10.2+SDKforSalesforceMobile</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d2/dc8/page_install.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Use the SDK in Existing Project </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This document contains information on how to link SalesforceSDK project with your newly created Cascades project. This document focus on Blackberry's Momentics IDE 2.1. If you are not using this IDE for development, you could skip this document.</p>
<h1><a class="anchor" id="section_approach_1"></a>
Recommended Procedure</h1>
<p>The latest Momentics IDE 2.1 introduced a plug-in called "Add Library". This plug-in provides a convenient way to link shared library to your project. This plug-in assumes that the location of your application project and the library project on the file system are siblings. However, this is not always the case. For example, your application project is version controlled by Git and the physical location is inside Git's working directory, which is outside of your Eclipse workspace, but your SalesforceSDK project stays in our repo's working directory. The build process would fail if you have such projects setup. The following procedure take the advantage of "Add Library" plug-in and fix the mentioned issue.</p>
<ul>
<li>Import SalesforceSDK. Make sure you have imported our SalesforceSDK project into the same Eclipse workspace as your project. The project name should be exactly "SalesforceSDK". Project can be imported using <b>"File-&gt;Import..."</b></li>
<li>Set a Environment Variable. Go to Momentics's <b>Preference-&gt;C/C++-&gt;Build-&gt;Environment</b>, and click <em>"Add"</em>. In the dialog, input <b>SALESFORCE_SDK_LOC</b> as the variable name and set the value to be the absolute path to your SalesforceSDK project. For example: <em>/Workspace_Blackberry/git/SalesforceMobileSDK-BlackBerry10/SalesforceSDK</em> <dl class="section note"><dt>Note</dt><dd>Remember to update it if you changed your Salesforce SDK location on the file system.</dd></dl>
</li>
<li>Create your Casecades Project. Use New Project Wizard and Cascades templates to create a new project</li>
<li>Add Library<ol type="1">
<li>Select your project in <b>Project Explorer</b> right-click. Select <b>Configure-&gt;Add Library</b>.</li>
<li>Choose <em>"Library project in the workspace"</em> and click "Next".</li>
<li>Check both <em>"Salesforce"</em> and <em>"include"</em> folder and click "Finish".</li>
<li>Eclipse will do the necessary configuration at this point.</li>
</ol>
</li>
<li><b>Optional</b> Edit .cproject file.<ol type="1">
<li>Open <b>Navigator View</b> and find .cproject.</li>
<li>Search for <em>"com.qnx.qcc.option.compiler.includePath"</em> and remove all occurrences of following lines: <div class="fragment"><div class="line">&lt;option <span class="keywordtype">id</span>=<span class="stringliteral">&quot;com.qnx.qcc.option.compiler.includePath.##########&quot;</span> name=<span class="stringliteral">&quot;Include Directories (-I)&quot;</span> superClass=<span class="stringliteral">&quot;com.qnx.qcc.option.compiler.includePath&quot;</span> valueType=<span class="stringliteral">&quot;includePath&quot;</span>&gt;</div>
<div class="line">    &lt;listOptionValue builtIn=<span class="stringliteral">&quot;false&quot;</span> value=<span class="stringliteral">&quot;${workspace_loc:/SalesforceSDK/include}&quot;</span>/&gt;</div>
<div class="line">&lt;/option&gt;</div>
</div><!-- fragment --></li>
<li>The Momentics sometimes incorrectly insert absolution path of .so file. To fix this, search for <em>"com.qnx.qcc.option.linker.libraryPaths"</em> and you would find some lines like: <div class="fragment"><div class="line">&lt;option <span class="keywordtype">id</span>=<span class="stringliteral">&quot;com.qnx.qcc.option.linker.libraryPaths.161951655&quot;</span> name=<span class="stringliteral">&quot;Library Paths (-L)&quot;</span> superClass=<span class="stringliteral">&quot;com.qnx.qcc.option.linker.libraryPaths&quot;</span> valueType=<span class="stringliteral">&quot;libPaths&quot;</span>&gt;</div>
<div class="line">    &lt;listOptionValue builtIn=<span class="stringliteral">&quot;false&quot;</span> value=<span class="stringliteral">&quot;/Path/To/Your_Library/SalesforceSDK/arm/so.le-v7-g&quot;</span>/&gt;</div>
<div class="line">&lt;/option&gt;</div>
</div><!-- fragment --> Change the absolute path to relative path like <em>${workspace_loc:/Path/To/The/Livrary.so</em>. <dl class="section note"><dt>Note</dt><dd>${workspace_loc:SalesforceSDK/arm} is different from ${workspace_loc}/SalesforceSDK/arm</dd></dl>
</li>
<li>Save the file and refresh the project.</li>
</ol>
</li>
<li>Edit <em>Makefile</em> under project's root folder. Add following lines before <em>include mk/cs-base.mk</em>: <div class="fragment"><div class="line">QMAKEFEATURES = $(SALESFORCE_SDK_LOC)</div>
<div class="line">export QMAKEFEATURES</div>
</div><!-- fragment --></li>
<li>Edit your project's <em>.pro</em> file. Add following lines after <em>include(config.pri)</em>: <div class="fragment"><div class="line">PRE_TARGETDEPS ~= s/.*SalesforceSDK.+/</div>
<div class="line">CONFIG += salesforcesdk</div>
</div><!-- fragment --></li>
<li>Edit <em>bar_descripter.xml</em>.<ol type="1">
<li>Add Salesforce SDK's assets to your application. Insert following line at the end of the file: <div class="fragment"><div class="line">&lt;asset path=<span class="stringliteral">&quot;${workspace_loc:/SalesforceSDK/assets}&quot;</span>&gt;assets&lt;/asset&gt;</div>
</div><!-- fragment --></li>
<li>Double check packaging rules for each configuration. For example, the following configuration is WRONG: <div class="fragment"><div class="line">&lt;configuration name=<span class="stringliteral">&quot;Device-Debug&quot;</span>&gt;</div>
<div class="line">    &lt;platformArchitecture&gt;armle-v7&lt;/platformArchitecture&gt;</div>
<div class="line">    &lt;asset path=<span class="stringliteral">&quot;arm/o.le-v7-g/SalesforceSDKDemo&quot;</span> entry=<span class="stringliteral">&quot;true&quot;</span> type=<span class="stringliteral">&quot;Qnx/Elf&quot;</span>&gt;SalesforceSDKDemo&lt;/asset&gt;</div>
<div class="line">    &lt;asset path=<span class="stringliteral">&quot;${workspace_loc:/SalesforceSDK/arm/so.le-v7/libSalesforceSDK.so}&quot;</span> type=<span class="stringliteral">&quot;Qnx/Elf&quot;</span>&gt;lib/libSalesforceSDK.so.1&lt;/asset&gt;</div>
<div class="line">&lt;/configuration&gt;</div>
</div><!-- fragment --> Note that the application's binary asset path doesn't match with library's .so path (<em>so.le-v7</em> should be <em>so.le-v7-g</em>). The correct configuration should be: <div class="fragment"><div class="line">&lt;configuration name=<span class="stringliteral">&quot;Device-Debug&quot;</span>&gt;</div>
<div class="line">    &lt;platformArchitecture&gt;armle-v7&lt;/platformArchitecture&gt;</div>
<div class="line">    &lt;asset path=<span class="stringliteral">&quot;arm/o.le-v7-g/SalesforceSDKDemo&quot;</span> entry=<span class="stringliteral">&quot;true&quot;</span> type=<span class="stringliteral">&quot;Qnx/Elf&quot;</span>&gt;SalesforceSDKDemo&lt;/asset&gt;</div>
<div class="line">    &lt;asset path=<span class="stringliteral">&quot;${workspace_loc:/SalesforceSDK/arm/so.le-v7-g/libSalesforceSDK.so}&quot;</span> type=<span class="stringliteral">&quot;Qnx/Elf&quot;</span>&gt;lib/libSalesforceSDK.so.1&lt;/asset&gt;</div>
<div class="line">&lt;/configuration&gt;</div>
</div><!-- fragment --></li>
</ol>
</li>
<li>All configuration has been done, you now have the Salesforce SDK linked to your project. But to start using the SDK, you still need to change couple lines of code.<ol type="1">
<li>Open your <em>applicationui.hpp</em>, and make your ApplicationUI subclass of <code><a class="el" href="../../d2/d6b/classsf_1_1_s_f_abstract_application_u_i.html" title="Abstract base class for the main application UI class. ">sf::SFAbstractApplicationUI</a>:</code> <div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d3/d81/_s_f_abstract_application_u_i_8h.html">core/SFAbstractApplicationUI.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">namespace </span>sf {</div>
<div class="line">    <span class="keyword">class </span>SFGenericTask;</div>
<div class="line">    <span class="keyword">class </span>SFResult;</div>
<div class="line">    <span class="keyword">class </span>SFOAuthInfo;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span>ApplicationUI : <span class="keyword">public</span> <a class="code" href="../../d2/d6b/classsf_1_1_s_f_abstract_application_u_i.html">sf::SFAbstractApplicationUI</a></div>
<div class="line">{</div>
<div class="line">    Q_OBJECT</div>
<div class="line"></div>
<div class="line">    <span class="comment">// The rest of your class members</span></div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>Define three const variables in your <em>applicationui.cpp</em>: <div class="fragment"><div class="line">QString <span class="keyword">const</span> sf::SFRemoteAccessConsumerKey = <span class="stringliteral">&quot;Your Force.com&#39;s oAuth client id&quot;</span>;</div>
<div class="line">QString <span class="keyword">const</span> sf::SFOAuthRedirectURI = <span class="stringliteral">&quot;Your Force.com&#39;s oAuth redirect URI&quot;</span>;</div>
<div class="line">QString <span class="keyword">const</span> sf::SFDefaultRestApiVersion = <span class="stringliteral">&quot;/v29.0&quot;</span>; <span class="comment">//REST API version</span></div>
</div><!-- fragment --></li>
<li>Call baseclass's constructor: <div class="fragment"><div class="line">ApplicationUI::ApplicationUI(bb::cascades::Application *app) : sf::SFAbstractApplicationUI(app) {</div>
<div class="line"></div>
<div class="line"><span class="comment">//Your own code</span></div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ol>
</li>
<li>Alternatively, if you want to build a cascade html5 hybrid application, you need to make your ApplicationUI class a subclass of SFHybridApplicationUI instead and change your main.qml slightly. See the SalesforceSDKHybridDemo project for a complete example.<ol type="1">
<li>Open your <em>applicationui.hpp</em>, and make your ApplicationUI subclass of <code><a class="el" href="../../df/de8/classsf_1_1_s_f_hybrid_application_u_i.html" title="Abstract base class for the main application UI class in a cascade html5 hybrid application. ">sf::SFHybridApplicationUI</a>:</code> </li>
<li>Define three const variables in your <em>applicationui.cpp</em>: <div class="fragment"><div class="line">QString <span class="keyword">const</span> sf::SFRemoteAccessConsumerKey = <span class="stringliteral">&quot;Your Force.com&#39;s oAuth client id&quot;</span>;</div>
<div class="line">QString <span class="keyword">const</span> sf::SFOAuthRedirectURI = <span class="stringliteral">&quot;Your Force.com&#39;s oAuth redirect URI&quot;</span>;</div>
<div class="line">QString <span class="keyword">const</span> sf::SFDefaultRestApiVersion = <span class="stringliteral">&quot;/v29.0&quot;</span>; <span class="comment">//REST API version</span></div>
</div><!-- fragment --></li>
<li>Call base class's constructor, and call the setUpWebView and registerDefaultPlugin method at the end of your constructor <div class="fragment"><div class="line">ApplicationUI::ApplicationUI(bb::cascades::Application *app) : sf::SFHybridApplicationUI(app)</div>
<div class="line"> {</div>
<div class="line">    <span class="comment">// prepare the localization</span></div>
<div class="line">    m_pTranslator = <span class="keyword">new</span> QTranslator(<span class="keyword">this</span>);</div>
<div class="line">    m_pLocaleHandler = <span class="keyword">new</span> LocaleHandler(<span class="keyword">this</span>);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">bool</span> res = QObject::connect(m_pLocaleHandler, SIGNAL(systemLanguageChanged()), <span class="keyword">this</span>, SLOT(onSystemLanguageChanged()));</div>
<div class="line">    <span class="comment">// This is only available in Debug builds</span></div>
<div class="line">    Q_ASSERT(res);</div>
<div class="line">    <span class="comment">// Since the variable is not used in the app, this is added to avoid a</span></div>
<div class="line">    <span class="comment">// compiler warning</span></div>
<div class="line">    Q_UNUSED(res);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// initial load</span></div>
<div class="line">    onSystemLanguageChanged();</div>
<div class="line"></div>
<div class="line">    QmlDocument *qml = QmlDocument::create(<span class="stringliteral">&quot;asset:///main.qml&quot;</span>).parent(<span class="keyword">this</span>);</div>
<div class="line">    AbstractPane *root = qml-&gt;createRootObject&lt;AbstractPane&gt;();</div>
<div class="line">    app-&gt;setScene(root);</div>
<div class="line"></div>
<div class="line">    this-&gt;setupWebView(root);</div>
<div class="line">    this-&gt;registerDefaultPlugins();</div>
<div class="line"> }</div>
</div><!-- fragment --><ol type="a">
<li>In main.qml add SFHybridWebView as the main view <div class="fragment"><div class="line"><span class="keyword">import</span> bb.cascades 1.2</div>
<div class="line">import <span class="stringliteral">&quot;./salesforce&quot;</span></div>
<div class="line"></div>
<div class="line">Page {</div>
<div class="line">   <span class="keywordtype">id</span>: page</div>
<div class="line">   objectName: <span class="stringliteral">&quot;page&quot;</span>;</div>
<div class="line">   SFHybridWebView{}</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ol>
</li>
<li>In your assets folder, create a www folder, and add index.html there. This would be the starting point of your hybrid application.Your folder structure should look like this: assets/www/index.html.</li>
</ol>
</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Since the cascade <code>WebView</code> does not offer a way to override the cross-site-scripting constraint, unless the server you are dealing with follows the CORS standard and returns "Allow-CORS" http response header, you cannot use XMLHttpRequest to communicate with the server from javascript. We have provided the <code><a class="el" href="../../d7/dde/classsf_1_1_s_f_rest_plugin.html">sf::SFRestPlugin</a></code> as a bridge to overcome this difficulty. It exposes all the Salesforce Rest API calls for you to use in javascript. If you still wish to use XMLHttpRequest directly in your javascript, you can either modify your server side to return the "Allow-CORS" header, or create a custom plugin that channels the XMLHttpRequest call from javascript to native as described here <a href="http://supportforums.blackberry.com/t5/Native-Development/How-to-whitelist-sites-for-XHR-in-WebView/m-p/2476919/highlight/true#M27148">http://supportforums.blackberry.com/t5/Native-Development/How-to-whitelist-sites-for-XHR-in-WebView/m-p/2476919/highlight/true#M27148</a></dd></dl>
<ul>
<li>Now you can build and run your application. If your <code><a class="el" href="../../d4/dd0/namespacesf.html#ab0825c181a6f3c43963fb11f25cb781f">sf::SFRemoteAccessConsumerKey</a></code> and <code><a class="el" href="../../d4/dd0/namespacesf.html#a3631d6518680633189c7960c7d548006">sf::SFOAuthRedirectURI</a></code> is set correctly, you should see Salesforce's oAuth login page automatically loaded at application start up.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The steps above are tested with Momentics IDE 2.1.201310251603 on MacOS 10.9. If you use Windows, the procedures may differ. </dd></dl>
<dl class="section see"><dt>See Also</dt><dd>SFAbstractApplicationUI, SFHybridApplicationUI</dd></dl>
<h1><a class="anchor" id="section_approach_2"></a>
Convenient Template Project</h1>
<p>We also included an empty template project <b>SalesforceAppTemplate</b> under the same repository. This project have everything configured for you. All you need to do is:</p>
<ol type="1">
<li>Check out and import the project</li>
<li>Change the project's name and build targets</li>
<li>Define <code><a class="el" href="../../d4/dd0/namespacesf.html#ab0825c181a6f3c43963fb11f25cb781f">sf::SFRemoteAccessConsumerKey</a></code>, <code><a class="el" href="../../d4/dd0/namespacesf.html#a3631d6518680633189c7960c7d548006">sf::SFOAuthRedirectURI</a></code> and <code><a class="el" href="../../d4/dd0/namespacesf.html#a66aaf23690c020ae86ed11ec6286d67c">sf::SFDefaultRestApiVersion</a></code> in <em>applicationui.cpp</em> according to your Force.com configuration.</li>
</ol>
<p>Please see <a class="el" href="../../d5/dfe/page_get_started.html">Get Started</a> for tutorial. </p>
<dl class="section author"><dt>Author</dt><dd>Livan Yi Du </dd>
<dd>
Tim Shi </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Dec 5 2013 15:42:08 for Blackberry10SDKforSalesforceMobile by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
