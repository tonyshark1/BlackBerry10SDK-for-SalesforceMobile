<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Blackberry10SDKforSalesforceMobile: sf::SFPlugin Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Blackberry10SDKforSalesforceMobile
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Blackberry10.2+SDKforSalesforceMobile</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d7/d4c/classsf_1_1_s_f_plugin.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../da/d14/classsf_1_1_s_f_plugin-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">sf::SFPlugin Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The <a class="el" href="../../d7/d4c/classsf_1_1_s_f_plugin.html" title="The SFPlugin class is the base class for plugin implementations. ">SFPlugin</a> class is the base class for plugin implementations.  
 <a href="../../d7/d4c/classsf_1_1_s_f_plugin.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d3/dfd/_s_f_plugin_8h_source.html">hybrid/SFPlugin.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for sf::SFPlugin:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d7/d4c/classsf_1_1_s_f_plugin.png" usemap="#sf::SFPlugin_map" alt=""/>
  <map id="sf::SFPlugin_map" name="sf::SFPlugin_map">
<area href="../../d3/d9f/classsf_1_1_s_f_auth_plugin.html" title="The SFAuthPlugin class makes the methods on SFAuthenticationManager available to javascript. " alt="sf::SFAuthPlugin" shape="rect" coords="0,112,105,136"/>
<area href="../../d7/dde/classsf_1_1_s_f_rest_plugin.html" title="The SFRestPlugin class makes the methods on SFRestAPI available to javascript. " alt="sf::SFRestPlugin" shape="rect" coords="115,112,220,136"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a406cade4600320f0502e5d89aae1ca64"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d4c/classsf_1_1_s_f_plugin.html#a406cade4600320f0502e5d89aae1ca64">SFPlugin</a> (WebView *webView)</td></tr>
<tr class="separator:a406cade4600320f0502e5d89aae1ca64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01833319fbcb2e7e5ca1b1145c3b66ec"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d4c/classsf_1_1_s_f_plugin.html#a01833319fbcb2e7e5ca1b1145c3b66ec">~SFPlugin</a> ()</td></tr>
<tr class="separator:a01833319fbcb2e7e5ca1b1145c3b66ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ac93c0e88b179b82b08717ebe9a77ad15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d4c/classsf_1_1_s_f_plugin.html#ac93c0e88b179b82b08717ebe9a77ad15">evalJavascript</a> (const QString &amp;js)</td></tr>
<tr class="separator:ac93c0e88b179b82b08717ebe9a77ad15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaea46873c5a06ab57f8845f33ab24ac2"><td class="memItemLeft" align="right" valign="top">QString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d4c/classsf_1_1_s_f_plugin.html#aaea46873c5a06ab57f8845f33ab24ac2">variantToJSON</a> (const QVariant &amp;map)</td></tr>
<tr class="separator:aaea46873c5a06ab57f8845f33ab24ac2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2dfa4050f7def46a8f5babe24c400ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d4c/classsf_1_1_s_f_plugin.html#ac2dfa4050f7def46a8f5babe24c400ae">sendPluginResult</a> (const <a class="el" href="../../de/d65/classsf_1_1_s_f_plugin_result.html">SFPluginResult</a> &amp;result, const QString &amp;callbackId)</td></tr>
<tr class="separator:ac2dfa4050f7def46a8f5babe24c400ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a6e257ebe9f5dfbc25a50120a74fadc18"><td class="memItemLeft" align="right" valign="top">WebView *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d4c/classsf_1_1_s_f_plugin.html#a6e257ebe9f5dfbc25a50120a74fadc18">mWebView</a></td></tr>
<tr class="separator:a6e257ebe9f5dfbc25a50120a74fadc18"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The <a class="el" href="../../d7/d4c/classsf_1_1_s_f_plugin.html" title="The SFPlugin class is the base class for plugin implementations. ">SFPlugin</a> class is the base class for plugin implementations. </p>
<p>The class provides methods to communicate with javascript</p>
<h2>Usage </h2>
<p>Create a concrete subclass of this class Declare the methods that can be accessed from javascript as Q_INVOKABLE. The method should take only one parameter of type <a class="el" href="../../d4/dcc/classsf_1_1_s_f_invoked_url_command.html" title="The SFInvokedUrlCommand encapsulates the information that javascript needs to pass to native code in ...">SFInvokedUrlCommand</a> <code><a class="el" href="../../d4/dcc/classsf_1_1_s_f_invoked_url_command.html" title="The SFInvokedUrlCommand encapsulates the information that javascript needs to pass to native code in ...">SFInvokedUrlCommand</a></code> encapsulates the information important to the invocation when the call was made from javascript side </p>
<div class="fragment"><div class="line"><span class="keyword">class </span>SFAuthPlugin : <span class="keyword">public</span> <a class="code" href="../../d7/d4c/classsf_1_1_s_f_plugin.html#a406cade4600320f0502e5d89aae1ca64">SFPlugin</a>{</div>
<div class="line"> Q_OBJECT</div>
<div class="line"> <span class="comment">//your own member variable and method declaration as required</span></div>
<div class="line"></div>
<div class="line"> <span class="comment">//declare the methods that can be invoked from javascript</span></div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line"> Q_INVOKABLE</div>
<div class="line"> <span class="keywordtype">void</span> login(<span class="keyword">const</span> SFInvokedUrlCommand&amp; command);</div>
<div class="line">}</div>
</div><!-- fragment --><p>In the implementation of the method, call the native code. In this case, because the login process is asynchronous, we keep a reference to the callbackId so that after the login is completed we can retrieve the callbackId and execute the call back function in javascript Note the plugin instance is set to receive the login success signal from <code><a class="el" href="../../d9/d20/classsf_1_1_s_f_authentication_manager.html" title="A singleton class that manages the oAuth 2.0 user agent/refresh flow. ">SFAuthenticationManager</a></code> </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="../../d3/d9f/classsf_1_1_s_f_auth_plugin.html#a9919b061ab842ee209c11ffa0365d4aa">SFAuthPlugin::login</a>(<span class="keyword">const</span> SFInvokedUrlCommand&amp; command){</div>
<div class="line"> callbackMap.insert(command.getMethodName(), command.getCallbackId());</div>
<div class="line"> <a class="code" href="../../d9/d20/classsf_1_1_s_f_authentication_manager.html#a80814d1dec7f4c2afca9c6f096a48805">SFAuthenticationManager::instance</a>()-&gt;<a class="code" href="../../d9/d20/classsf_1_1_s_f_authentication_manager.html#ad8adb46a9fc5d8e9bfca5515f4837f33">login</a>();</div>
<div class="line">}</div>
</div><!-- fragment --><p>When we received the login success signal we retrieve the callbackId and let javascript know that the call back should be executed. </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="../../d3/d9f/classsf_1_1_s_f_auth_plugin.html#a64f69c38ce98ff5acfe948788bab27ca">SFAuthPlugin::onSFOAuthFlowSuccess</a>(SFOAuthInfo* info){</div>
<div class="line"> QString callbackId = callbackMap.value(<span class="stringliteral">&quot;login&quot;</span>); <span class="comment">//matching method name</span></div>
<div class="line"> QVariantMap message;</div>
<div class="line"> message.insert(kPluginAuthType, info-&gt;getAuthType());</div>
<div class="line"> message.insert(kPluginAuthStatus, <a class="code" href="../../d4/dd0/namespacesf.html#aba56956dc81c02b9947ec14d583762dca0b177ccca3b6f68482a69673b699cd5f">SFAuth_SUCCESS</a>);</div>
<div class="line"> SFPluginResult result = SFPluginResult(<a class="code" href="../../d4/dd0/namespacesf.html#a45fec908a1a23987e03f02404f7802abae7ccef9efebc4717a48bfc03889e4b49">SFCommandStatus_OK</a>, message, <span class="keyword">false</span>);</div>
<div class="line"> <span class="keywordflow">if</span> (!callbackId.isEmpty() &amp;&amp; !callbackId.isNull()){</div>
<div class="line">    this-&gt;<a class="code" href="../../d7/d4c/classsf_1_1_s_f_plugin.html#ac2dfa4050f7def46a8f5babe24c400ae">sendPluginResult</a>(result,callbackId);</div>
<div class="line">    callbackMap.remove(<span class="stringliteral">&quot;login&quot;</span>);</div>
<div class="line"> }<span class="keywordflow">else</span>{</div>
<div class="line">    QString js = QString(<span class="stringliteral">&quot;%1(%2)&quot;</span>).arg(kLoginDefaultSuccessCallback, <a class="code" href="../../d7/d4c/classsf_1_1_s_f_plugin.html#aaea46873c5a06ab57f8845f33ab24ac2">variantToJSON</a>(message));</div>
<div class="line">    this-&gt;<a class="code" href="../../d7/d4c/classsf_1_1_s_f_plugin.html#ac93c0e88b179b82b08717ebe9a77ad15">evalJavascript</a>(js);</div>
<div class="line"> }</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../d3/d9f/classsf_1_1_s_f_auth_plugin.html" title="The SFAuthPlugin class makes the methods on SFAuthenticationManager available to javascript. ">SFAuthPlugin</a>, <a class="el" href="../../d7/dde/classsf_1_1_s_f_rest_plugin.html" title="The SFRestPlugin class makes the methods on SFRestAPI available to javascript. ">SFRestPlugin</a>, <a class="el" href="../../d4/dcc/classsf_1_1_s_f_invoked_url_command.html" title="The SFInvokedUrlCommand encapsulates the information that javascript needs to pass to native code in ...">SFInvokedUrlCommand</a>, <a class="el" href="../../de/d65/classsf_1_1_s_f_plugin_result.html" title="The SFPluginResult encapsulates the information that a plugin needs to pass back to the javascript wh...">SFPluginResult</a>, SFHybridApplicationui </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Tim Shi </dd></dl>

<p>Definition at line <a class="el" href="../../d3/dfd/_s_f_plugin_8h_source.html#l00089">89</a> of file <a class="el" href="../../d3/dfd/_s_f_plugin_8h_source.html">SFPlugin.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a406cade4600320f0502e5d89aae1ca64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sf::SFPlugin::SFPlugin </td>
          <td>(</td>
          <td class="paramtype">WebView *&#160;</td>
          <td class="paramname"><em>webView</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a01833319fbcb2e7e5ca1b1145c3b66ec"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual sf::SFPlugin::~SFPlugin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ac93c0e88b179b82b08717ebe9a77ad15"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sf::SFPlugin::evalJavascript </td>
          <td>(</td>
          <td class="paramtype">const QString &amp;&#160;</td>
          <td class="paramname"><em>js</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">js</td><td>the javascript to be executed in the web view </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac2dfa4050f7def46a8f5babe24c400ae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sf::SFPlugin::sendPluginResult </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d65/classsf_1_1_s_f_plugin_result.html">SFPluginResult</a> &amp;&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QString &amp;&#160;</td>
          <td class="paramname"><em>callbackId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Send the result to web view </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">result</td><td>The result to be sent to web view, see <code><a class="el" href="../../de/d65/classsf_1_1_s_f_plugin_result.html" title="The SFPluginResult encapsulates the information that a plugin needs to pass back to the javascript wh...">SFPluginResult</a></code> </td></tr>
    <tr><td class="paramname">callbackId</td><td>The id of the callback function to be executed in the web view's javascript </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aaea46873c5a06ab57f8845f33ab24ac2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QString sf::SFPlugin::variantToJSON </td>
          <td>(</td>
          <td class="paramtype">const QVariant &amp;&#160;</td>
          <td class="paramname"><em>map</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Helper method for converitng a QVariant to json. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">map</td><td>the QVariant to be serialized into json </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>json string representing the map </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a6e257ebe9f5dfbc25a50120a74fadc18"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">WebView* sf::SFPlugin::mWebView</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/dfd/_s_f_plugin_8h_source.html#l00096">96</a> of file <a class="el" href="../../d3/dfd/_s_f_plugin_8h_source.html">SFPlugin.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d4/dd0/namespacesf.html">sf</a></li><li class="navelem"><a class="el" href="../../d7/d4c/classsf_1_1_s_f_plugin.html">SFPlugin</a></li>
    <li class="footer">Generated on Thu Dec 5 2013 15:42:09 for Blackberry10SDKforSalesforceMobile by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
